function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},s=e.parcelRequire5951;null==s&&((s=function(t){if(t in n)return n[t].exports;if(t in r){var e=r[t];delete r[t];var s={id:t,exports:{}};return n[t]=s,e.call(s.exports,s,s.exports),s.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){r[t]=e},e.parcelRequire5951=s),s.register("2bZdl",(function(e,n){t(e.exports,"addCards",(()=>c));var r=s("67T2y"),a=s("77CKc"),i=s("9b6hp");const o=document.querySelector(".cards__inner");function c(t){for(let e of t)o.appendChild(d(e));(0,i.hiddenCards)()}function d(t){const e=document.createElement("div");return e.classList.add("card"),e.innerHTML=`\n\t<div class="card__view">\n\t\t<img src="${t.image}" alt="image" class="card__img">\n\t\t<button type="button" class="card__btn-quick-view" data-id="${t.id}">Быстрый просмотр</button>\n\t</div>\n\t<div class="card__inner">\n\t\t<div class="card__info">\n\t\t\t<h4 class="card__title">${t.title}</h4>\n\t\t\t<h5 class="card__price">${t.price+"$"}</h5>\n\t\t</div>\n\t\t<div class="card__subinfo">\n\t\t\t<span class="card__discount">${"-"+t.sale+"%"}</span>\n\t\t\t<span class="card__old-price">${t.old_price+"$"}</span>\n\t\t</div>\n\t</div>\n\t<button type="button" class="card__btn-add-basket" data-id="${t.id}">В корзину</button>`,e}let l=!1;window.addEventListener("DOMContentLoaded",r.getCards),o.addEventListener("click",(function(t){if(t.target.classList.contains("card__btn-quick-view")){const e=t.target.dataset.id,n=r.alyaStore.find((t=>t.id===e));if(n){const t=function(t){const e=document.createElement("div");return e.classList.add("card-modal"),e.innerHTML=`\n\t\t<div class="container">\n\t\t\t<div class="card-modal__wrapper">\n\t\t\t\t<img class="card-modal__img" src="${t.image}">\n\t\t\t\t<div class="card-modal__inner">\n\t\t\t\t\t<div class="modal-header card-modal__header">\n\t\t\t\t\t\t<h2 class="modal-header__title">${t.title}</h2>\n\t\t\t\t\t\t<button class="btn-close" type="button"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class="card-modal__info"><span>Состав:</span> Lorem ipsum dolor sit amet consectetur adipisicing elit. Necessitatibus veniam ipsam nostrum nisi architecto similique praesentium culpa nam illum modi.</p>\n\t\t\t\t\t<div class="card-modal__subinfo">\n\t\t\t\t\t\t<h3 class="card-modal__price">${t.price+"$"}</h3>\n\t\t\t\t\t\t<h4 class="card-modal__old-price">${t.old_price+"$"}</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type="button" class="card-modal__btn-add-basket" data-id="${t.id}">Добавить в корзину</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`,e}(n);o.appendChild(t)}}})),o.addEventListener("click",(function(t){if(t.target.classList.contains("card__btn-add-basket")||t.target.classList.contains("card-modal__btn-add-basket")){const e=t.target.dataset.id,n=r.alyaStore.find((t=>t.id===e));if(n){let t=localStorage.getItem("basketStore"),e=[];t&&(e=JSON.parse(t)),e.push(n),localStorage.setItem("basketStore",JSON.stringify(e)),(0,a.linkStoreToUserData)()}}})),o.addEventListener("click",(function(t){if(t.target.classList.contains("card__title"))if(l)!function(){const t=document.querySelectorAll(".card");for(let e=0;e<t.length;e++)t[e].style.display="flex"}(),l=!1;else{!function(t){const e=document.querySelectorAll(".card__title");for(let n=0;n<e.length;n++){const r=e[n].closest(".card");e[n].textContent===t?r.style.display="flex":r.style.display="none"}}(t.target.textContent),l=!0}})),o.addEventListener("click",(function(t){t.target.classList.contains("card__btn-del-all-basket")&&localStorage.removeItem("basketStore")})),o.addEventListener("click",(function(t){if(t.target.classList.contains("btn-close")){t.target.closest(".card-modal").remove()}}))})),s.register("67T2y",(function(e,n){t(e.exports,"alyaStore",(()=>a)),t(e.exports,"getCards",(()=>i)),t(e.exports,"getDataCards",(()=>o));var r=s("2bZdl");let a=[];function i(){fetch("https://646f451109ff19b12086e48a.mockapi.io/wildberries/cards").then((t=>{if(200===t.status)return t.json();throw Error(t)})).then((t=>{a=t,(0,r.addCards)(t)})).catch((t=>{alert(t)}))}function o(){return fetch("https://646f451109ff19b12086e48a.mockapi.io/wildberries/cards").then((t=>t.json())).then((t=>t)).catch((t=>{throw t}))}})),s.register("77CKc",(function(e,n){t(e.exports,"linkStoreToUserData",(()=>i));var r=s("02iEE"),a=s("3LgNA");function i(){const t=JSON.parse(localStorage.getItem("basketStore")),e=(0,a.getTokenStore)();e&&r.AuthenticationApi.changeUserOrders(e,t)}})),s.register("02iEE",(function(e,n){t(e.exports,"AuthenticationApi",(()=>r));class r{static userUrl="https://646e07219c677e23218ae1e2.mockapi.io/users/user";static setUser(t,e,n){return new Promise(((r,s)=>{fetch(this.userUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:t,password:e,token:n,orders:[]})}).then((t=>{t.ok?r():s(new Error("Failed to set user"))})).catch((t=>s(t)))}))}static getUserByLogin(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>t===e.login)))).catch((t=>{throw t}))}static getUserByToken(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>t===e.token.toString())))).catch((t=>{throw t}))}static async changeUserOrders(t,e){const n=(await r.getUserByToken(t)).id;return fetch(`${this.userUrl}/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:e})}).then((t=>{if(t.ok)return t.json();throw new Error("Failed to change user data")})).catch((t=>{throw t}))}}})),s.register("3LgNA",(function(e,n){t(e.exports,"getTokenStore",(()=>a)),t(e.exports,"removeTokenStore",(()=>i)),t(e.exports,"setTokenStore",(()=>o));var r=s("fEuAQ");function a(){return sessionStorage.getItem(r.USER_TOKEN)}function i(){return sessionStorage.removeItem(r.USER_TOKEN)}function o(t){return sessionStorage.setItem(r.USER_TOKEN,t)}})),s.register("fEuAQ",(function(e,n){t(e.exports,"USER_TOKEN",(()=>r));const r="token"})),s.register("9b6hp",(function(e,n){t(e.exports,"hiddenCards",(()=>a));const r=document.querySelector(".cards__inner");let s=9;function a(){const t=document.querySelector(".cards__btn-show-more");let e=0;const n=Array.from(r.children);for(;e<s&&e<n.length;e++)n[e].classList.add("card_active");n.forEach((t=>{t.classList.contains("card_active")&&setTimeout((()=>t.style.opacity="1"),100)})),e>=n.length?t.style.display="none":t.style.display="block",t.addEventListener("click",i)}function i(){s+=9,a()}})),s("2bZdl");
//# sourceMappingURL=index.f7a95d1c.js.map
